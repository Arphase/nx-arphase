<div nz-row
     [nzGutter]="[24, 8]">
  <div nz-col
       class="-12 col-md-6">
    <ivt-searchbar (valueChange)="updateSearchBarFilter($event)"></ivt-searchbar>
  </div>

  <div nz-col
       nxzFlex="auto"
       class="flex-end">
    <button nz-button
            [routerLink]="['new']"
            type="button"
            nzType="primary">
      Nuevo vehículo
    </button>
  </div>
</div>


<nz-divider></nz-divider>

<div nz-row
     [nzGutter]="12">
  <div nz-col
       nzFlex="auto"
       class="flex-end">
    {{ info?.pageStart }}-{{ info?.pageEnd }} de {{ info?.total }}
  </div>
</div>

<nz-divider></nz-divider>

<nz-table #table
          nzSize="small"
          [nzData]="list"
          [nzFrontPagination]="false"
          [nzTotal]="info?.total"
          [nzPageIndex]="info?.pageIndex"
          [nzLoading]="loading"
          (nzQueryParams)="filterItems.emit($event)">
  <thead>
    <tr nz-row>
      <th nzSortFn="true"
          nzColumnKey="user.firstName"
          nz-col
          nzMd="5">VIN</th>
      <th nzSortFn="true"
          nzColumnKey="user.email"
          nz-col
          nzMd="4">Marca</th>
      <th nzSortFn="true"
          nzColumnKey="user.createdAt"
          nz-col
          nzMd="4">Modelo</th>
      <th nzSortFn="true"
          nzColumnKey="company.businessName"
          nz-col
          nzMd="4">Versión</th>
      <th nzSortFn="true"
          nzColumnKey="company.businessName"
          nz-col
          nzMd="3">Año</th>
      <th nzSortFn="true"
          nzColumnKey="company.businessName"
          nz-col
          nzMd="3">Fecha de alta</th>
      <th nz-col
          nzXs="1"></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of table.data"
        nz-row>
      <td nz-col
          nzXs="5">{{ item?.vin | empty }}</td>
      <td nz-col
          nzXs="4">{{ item?.brand | empty }}</td>
      <td nz-col
          nzXs="4">{{ item?.model | empty }}</td>
      <td nz-col
          nzXs="4">{{ item?.version | empty }}</td>
      <td nz-col
          nzXs="3">{{ item?.year | empty }}</td>
      <td nz-col
          nzXs="3">{{ item?.createdAt | date: 'dd/MM/yy' }}</td>
      <td nz-col
          nzXs="1">
        <button nz-button
                nz-dropdown
                [nzDropdownMenu]="menu"
                nzType="text"
                nz-tooltip
                nzTooltipTitle="Acciones"
                nzTrigger="click">
          <i nz-icon
             nzType="more"
             nzTheme="outline"></i>
        </button>
      </td>
      <nz-dropdown-menu #menu="nzDropdownMenu">
        <ul nz-menu>
          <li nz-menu-item
              nz-tooltip
              [nzTooltipTitle]="!isElegible(item) ?  'Solo se pueden generar garantías a los vehículos aptos para garantizar' : ''"
              [nzDisabled]="!isElegible(item)"
              (click)="isElegible(item) && createGuarantee.emit(item)">
            Generar garantía
          </li>
          <li nz-menu-item
              *ngIf="canManageRevisions"
              (click)="goToRevisions.emit(item)">
            Manejar revisiones
          </li>
          <li nz-menu-item
              *ngIf="canCreateReviewRequest"
              (click)="createRevisionRequest.emit(item)">
            Solicitar revisión
          </li>
          <li nz-menu-item
              [routerLink]="[item.id]">
            Editar vehículo
          </li>
          <li nz-menu-item
              class="text-danger"
              (click)="delete.emit(item)">
            Eliminar vehículo
          </li>
        </ul>
      </nz-dropdown-menu>
    </tr>
  </tbody>
</nz-table>
