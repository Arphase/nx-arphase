<div nz-row
     [nzGutter]="[24, 8]">
  <div nz-col
       nzSm="16"
       nzMd="20"
       nzLg="12">
    <ivt-searchbar (valueChange)="updateSearchBarFilter($event)"></ivt-searchbar>
  </div>

  <div nz-col
       nzSm="8"
       nzMd="4"
       class="flex-start">
    <button nz-button
            nzType="text"
            [ngClass]="{ 'bg-primary text-white': showFilters }"
            matTooltip="Filtrar"
            (click)="toggleFilter()">
      <i nz-icon
         nzType="filter"
         nzTheme="outline"></i>
    </button>
    <button nz-button
            nzType="text"
            matTooltip="Exportar a Excel"
            [nzLoading]="loadingExcel"
            (click)="exportExcel.emit()">
      <i nz-icon
         nzType="export"
         nzTheme="outline"></i>
    </button>
  </div>
  <div nz-col
       nzMd="12"
       nzLg="4"
       class="flex-start">
    <h6 class="m-0"> Resultado(s): {{ list.length }} </h6>
  </div>

  <div nz-col
       nzFlex="auto"
       class="flex-end pr-0">
    <button nz-button
            [routerLink]="['new']"
            type="button"
            nzType="primary">
      Nueva garantía
    </button>
  </div>
</div>

<div [hidden]="!showFilters"
     nz-row
     [nzGutter]="[24, 8]"
     class="mx-0 mb-4 rounded mt-3 py-3 px-2">
  <div nz-col
       class="px-1 my-2 filter-column">
    <ivt-date-filter class="mr-3"
                     label="Fecha"
                     [dateTypeOptions]="dateTypeOptions"
                     (filterItems)="updateDateFilter($event)">
    </ivt-date-filter>
  </div>
  <div nz-col
       class="px-1 my-2 filter-column">
    <ivt-radio-filter class="mr-3"
                      label="Estatus"
                      [options]="statusOptions"
                      (filterItems)="updateStatusFilter($event)">
    </ivt-radio-filter>
  </div>
  <div nz-col
       class="px-1 my-2 filter-column">
    <ivt-checkbox-filter *ngIf="groupOptions?.length"
                         class="mr-3"
                         label="Grupos"
                         [options]="groupOptions"
                         (filterItems)="updateGroupsFilters($event)">
    </ivt-checkbox-filter>
  </div>
  <div nz-col
       class="px-1 my-2 filter-column">
    <ivt-checkbox-filter *ngIf="companyOptions?.length"
                         class="mr-3"
                         label="Compañías"
                         [options]="companyOptions"
                         (filterItems)="updateCompaniesFilters($event)">
    </ivt-checkbox-filter>
  </div>
  <div nz-col
       class="px-1 my-2 filter-column">
    <ivt-checkbox-filter *ngIf="userOptions?.length"
                         class="mr-3"
                         label="Vendedores"
                         [options]="userOptions"
                         (filterItems)="updateUsersFilters($event)">
    </ivt-checkbox-filter>
  </div>
</div>

<div *ngIf="selectedIds.hasValue()"
     nz-row
     [nzGutter]="[24, 8]"
     class="mt-4 py-3 rounded">
  <div nz-col
       nzSpan="24">
    <button nz-button
            type="button"
            nzType="primary"
            (click)="createPaymentOrder.emit(selectedIds.selected)">
      Generar orden de pago
    </button>
  </div>
</div>

<nz-empty *ngIf="!list.length"
          nzNotFoundContent="No existen garantías que se cumplan con el criterio de búsqueda">
</nz-empty>

<ng-container *ngIf="list.length">
  <ivt-table-header class="d-block mt-4"
                    [columns]="columns"
                    (sort)="updateSort($event)"></ivt-table-header>

  <ivt-virtual-scroll height="60vh"
                      [list]="list"
                      [ignoreNextBatch]="!hasMoreItems || loading"
                      (nextBatchEmitter)="getMoreItems.emit()">
    <ng-template let-item>
      <ivt-guarantee-row-container [item]="item"
                                   [isSelected]="selectedIds.isSelected(item.id)"
                                   (selectItem)="onSelectItem(item.id)">
      </ivt-guarantee-row-container>
    </ng-template>
  </ivt-virtual-scroll>
</ng-container>
