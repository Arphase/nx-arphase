<ivt-row>
  <div class="color-status {{ backgroundClasses[item.status] }}"
       (mouseenter)="showStatusSubject.next(true)"
       (click)="showStatusSubject.next(true)"></div>

  <div [ngClass]="{ collapsed: !(visibleStatus$ | async)}"
       class="color-status-description {{ backgroundClasses[item.status] }} text-center p-3 flex-center">
    <div class="mx-2">
      <p class="text-white mb-0">{{ statusLabels[item.status] }}</p>
    </div>
  </div>
  <div class="col-1 d-flex justify-content-center">
    <mat-checkbox [disabled]="item?.amount"
                  [checked]="isSelected"
                  (change)="selectItem.emit(item)">
    </mat-checkbox>
  </div>
  <div class="col-2 col-sm-1">
    {{ item.id | folio }}
  </div>
  <div class="col-2 d-none d-lg-block d-xl-block">
    <ivt-text-truncate-tooltip [label]="item.vehicle?.vin"></ivt-text-truncate-tooltip>
  </div>
  <div class="col-2 d-none d-sm-block d-md-block d-lg-block d-xl-block">
    <ivt-text-truncate-tooltip [label]="item.paymentOrder?.distributor | empty"></ivt-text-truncate-tooltip>
  </div>
  <div class="col-3 col-sm-2 col-lg-1">
    {{ item.startDate | date: "dd/MM/yy" }}
  </div>
  <div class="col-3 col-sm-2 col-lg-1">
    {{ item.endDate | date: "dd/MM/yy" }}
  </div>
  <div class="col-2 col-lg-1 d-none d-lg-block d-xl-block">
    {{ item.createdAt | date: "dd/MM/yy" }}
  </div>
  <div class="col-2 d-none d-sm-block d-md-block d-lg-block d-xl-block text-right">
    <ivt-text-truncate-tooltip [label]="item.amount | currency | empty"></ivt-text-truncate-tooltip>
  </div>
  <div class="col-auto ml-auto pl-0">
    <button mat-icon-button
            matTooltip="Acciones"
            [loading]="loading"
            [matMenuTriggerFor]="actionsMenu">
      <mat-icon>more_vert</mat-icon>
    </button>
    <mat-menu #actionsMenu="matMenu">
      <button mat-menu-item
              [routerLink]="[item.id]">
        {{ isEditable ? 'Editar' : 'Ver' }} garantía
      </button>
      <button mat-menu-item
              [matMenuTriggerFor]="statusMenu">
        Cambiar estatus
      </button>
      <button mat-menu-item
              (click)="downloadPdf.emit(item.id)">
        Descargar PDF
      </button>
      <button mat-menu-item
              *ngIf="!item.paymentOrderId"
              (click)="createPaymentOrder.emit(item.id)">
        Generar orden de pago
      </button>
      <ng-container *ngIf="item.paymentOrderId">
        <button mat-menu-item
                (click)="downloadPaymentOrder.emit(item.paymentOrderId)">
          Descargar orden de pago
        </button>
        <button mat-menu-item
                (click)="updatePaymentOrder.emit(item.paymentOrderId)">
          Editar orden de pago
        </button>
      </ng-container>
      <button mat-menu-item
              (click)="editInvoiceNumber.emit(item)">
        Editar número de factura
      </button>
    </mat-menu>

    <mat-menu #statusMenu="matMenu">
      <button *ngFor="let menuOption of menuOptions"
              mat-menu-item
              class="status-option my-2"
              (click)="onChangeStatus(item.id, menuOption.value)">
        <span class="{{ menuOption.class }} text-white text-center rounded flex-center">
          {{ menuOption.label }}
        </span>
      </button>
    </mat-menu>
  </div>
</ivt-row>
