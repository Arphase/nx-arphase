<div nz-row>
  <div nz-col
       nzSpan="24">
    <h1 class="font-weight-light h2 text-primary">Dashboard</h1>
  </div>
</div>

<div nz-row>
  <div nz-col
       nzSpan="24">
    <nz-card>
      <ng-container *ngIf="data">
        <div nz-row
             [nzGutter]="12">
          <div nz-col
               nzSpan="24">
            <h3>Resumen de Garantías</h3>
          </div>
        </div>

        <nz-divider></nz-divider>

        <div nz-row
             nzAlign="middle"
             [nzGutter]="[12, 12]">
          <div nz-col>
            <ivt-date-filter label="Fecha"
                             [dateTypeOptions]="dateTypeOptions"
                             [currentDates]="queryParams?.dates"
                             (filterItems)="updateDateFilter($event)">
            </ivt-date-filter>
          </div>
          <ng-container *ivtCreatePermission>
            <div nz-col>
              <ivt-checkbox-filter label="Grupos"
                                   [options]="groupFilterInfo?.options"
                                   [loading]="groupFilterInfo?.loading"
                                   [last]="groupFilterInfo?.last"
                                   [pageIndex]="groupFilterInfo?.pageIndex"
                                   [preselectedOptions]="queryParams?.groupIds"
                                   (filterItems)="updateGroupsFilters($event)"
                                   (filterOptions)="filterGroupOptions.emit($event)">
              </ivt-checkbox-filter>
            </div>
            <div nz-col>
              <ivt-checkbox-filter label="Compañías"
                                   [options]="companyFilterInfo?.options"
                                   [loading]="companyFilterInfo?.loading"
                                   [last]="companyFilterInfo?.last"
                                   [pageIndex]="companyFilterInfo?.pageIndex"
                                   [preselectedOptions]="queryParams?.companyIds"
                                   (filterItems)="updateCompaniesFilters($event)"
                                   (filterOptions)="filterCompanyOptions.emit($event)">
              </ivt-checkbox-filter>
            </div>
          </ng-container>
          <div nz-col>
            <ivt-checkbox-filter label="Usuarios"
                                 [options]="userFilterInfo?.options"
                                 [loading]="userFilterInfo?.loading"
                                 [last]="userFilterInfo?.last"
                                 [pageIndex]="userFilterInfo?.pageIndex"
                                 [preselectedOptions]="queryParams?.userIds"
                                 (filterItems)="updateUsersFilters($event)"
                                 (filterOptions)="filterUserOptions.emit($event)">
            </ivt-checkbox-filter>
          </div>
        </div>

        <nz-divider></nz-divider>

        <nz-empty *ngIf="isEmpty"
                  nzNotFoundContent="No hay datos">
        </nz-empty>

        <div *ngIf="!isEmpty"
             nz-row>
          <div nz-col
               nzSm="24"
               [nzLg]="{ span: 18, offset: 3 }">
            <div class="grid">
              <ngx-charts-bar-vertical [results]="data"
                                       [scheme]="colors"
                                       [xAxis]="true"
                                       [yAxis]="true"
                                       [yAxisTickFormatting]="yAxisTickFormatting">
                <ng-template #tooltipTemplate
                             let-model="model">
                  {{ model.value | currency }}
                </ng-template>
              </ngx-charts-bar-vertical>
            </div>
          </div>
        </div>
      </ng-container>
    </nz-card>
  </div>
</div>
